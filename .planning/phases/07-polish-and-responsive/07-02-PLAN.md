---
phase: 07-polish-and-responsive
plan: 02
type: execute
wave: 2
depends_on: ["07-01"]
files_modified:
  - app/(dashboard)/providers/layout-transition.tsx
  - app/(dashboard)/layout.tsx
  - app/(dashboard)/page.tsx
  - app/(dashboard)/components/dashboard-metrics.tsx
  - app/(dashboard)/components/recent-jobs-list.tsx
  - app/(dashboard)/training/page.tsx
  - app/(dashboard)/training/jobs/page.tsx
  - app/(dashboard)/training/jobs/[id]/page.tsx
  - app/(dashboard)/training/configure/page.tsx
  - app/(dashboard)/deployments/page.tsx
  - app/(dashboard)/deployments/[id]/page.tsx
  - app/(dashboard)/deployments/components/deployments-table.tsx
  - app/globals.css
autonomous: true

must_haves:
  truths:
    - "Page transitions animate smoothly with fade + slide when navigating between routes"
    - "Animations respect prefers-reduced-motion accessibility setting"
    - "Dashboard metrics cards stack properly on mobile (1 col) and tablet (2 col)"
    - "Training jobs cards are readable on mobile with stacked layout instead of side-by-side"
    - "Deployments table scrolls horizontally on mobile instead of breaking layout"
    - "All pages have proper spacing and readable typography on 375px viewport"
  artifacts:
    - path: "app/(dashboard)/providers/layout-transition.tsx"
      provides: "FrozenRouter + LayoutTransition with Motion"
      contains: "AnimatePresence"
    - path: "app/(dashboard)/layout.tsx"
      provides: "Dashboard layout with LayoutTransition wrapper"
      contains: "LayoutTransition"
  key_links:
    - from: "app/(dashboard)/layout.tsx"
      to: "app/(dashboard)/providers/layout-transition.tsx"
      via: "import LayoutTransition"
      pattern: "LayoutTransition"
    - from: "app/(dashboard)/providers/layout-transition.tsx"
      to: "motion/react"
      via: "import AnimatePresence, motion"
      pattern: "from.*motion/react"
---

<objective>
Add smooth page transitions with Motion and make all views responsive across desktop, tablet, and mobile.

Purpose: Page transitions give the app a polished, app-like feel. Responsive design ensures the portfolio piece looks professional on any device a reviewer might use.
Output: LayoutTransition provider with FrozenRouter pattern, Motion-powered page animations, responsive fixes across all pages.
</objective>

<execution_context>
@/home/wraith/.claude/get-shit-done/workflows/execute-plan.md
@/home/wraith/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-polish-and-responsive/07-RESEARCH.md
@.planning/phases/07-polish-and-responsive/07-01-SUMMARY.md
@app/(dashboard)/layout.tsx
@app/(dashboard)/page.tsx
@app/(dashboard)/components/dashboard-metrics.tsx
@app/(dashboard)/training/page.tsx
@app/(dashboard)/training/jobs/page.tsx
@app/(dashboard)/training/jobs/[id]/page.tsx
@app/(dashboard)/deployments/page.tsx
@app/(dashboard)/deployments/[id]/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install Motion and create page transition system</name>
  <files>
    app/(dashboard)/providers/layout-transition.tsx
    app/(dashboard)/layout.tsx
    app/globals.css
  </files>
  <action>
    1. Install motion: `pnpm install motion`

    2. Create `app/(dashboard)/providers/layout-transition.tsx` ("use client"):
    - Import `useContext`, `useEffect`, `useRef` from react
    - Import `LayoutRouterContext` from `next/dist/shared/lib/app-router-context.shared-runtime`
    - Import `useSelectedLayoutSegment` from `next/navigation`
    - Import `AnimatePresence`, `motion`, `MotionConfig` from `motion/react`

    - Create `FrozenRouter` component:
      - Captures LayoutRouterContext and selectedLayoutSegment
      - Stores previous values in refs
      - On segment change, provides previous context to children (prevents App Router from unmounting during exit animation)
      - On stable segment, provides current context

    - Create `LayoutTransition` component:
      - Wraps children in `MotionConfig` with `reducedMotion="user"` (respects prefers-reduced-motion)
      - Uses `AnimatePresence` with `mode="wait"` and `initial={false}` (no animation on first load)
      - Wraps children in `motion.div` keyed by segment:
        - `initial`: { opacity: 0, y: 8 }
        - `animate`: { opacity: 1, y: 0 }
        - `exit`: { opacity: 0, y: -8 }
        - `transition`: { duration: 0.15, ease: "easeInOut" }
      - Inside motion.div, wrap children in FrozenRouter

    - Export `LayoutTransition` (named export)

    Keep animations subtle (y: 8px, 150ms) -- this is a professional dashboard, not a marketing site.

    3. Update `app/(dashboard)/layout.tsx`:
    - Import `LayoutTransition` from `./providers/layout-transition`
    - Wrap `{children}` inside `<main>` with `<LayoutTransition>{children}</LayoutTransition>`
    - Keep all existing layout structure (SidebarProvider, AppSidebar, header) unchanged

    4. Add to `app/globals.css` a utility to respect reduced motion for any CSS animations already in use:
    ```css
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }
    ```
    Add this AFTER existing CSS, before the closing of the file.

    IMPORTANT: Import from "motion/react" (NOT "framer-motion"). The package name is "motion" (not "framer-motion").
  </action>
  <verify>Run `pnpm build` -- verify motion is bundled and layout compiles. Check that LayoutRouterContext import resolves (this is an internal Next.js export that may change between versions -- if it fails, fall back to a simpler approach using just pathname-based key without FrozenRouter).</verify>
  <done>Page transitions animate with subtle fade+slide on route changes. MotionConfig respects prefers-reduced-motion. No animation on initial page load.</done>
</task>

<task type="auto">
  <name>Task 2: Responsive design audit and fixes across all pages</name>
  <files>
    app/(dashboard)/page.tsx
    app/(dashboard)/components/dashboard-metrics.tsx
    app/(dashboard)/components/recent-jobs-list.tsx
    app/(dashboard)/training/page.tsx
    app/(dashboard)/training/jobs/page.tsx
    app/(dashboard)/training/jobs/[id]/page.tsx
    app/(dashboard)/training/configure/page.tsx
    app/(dashboard)/deployments/page.tsx
    app/(dashboard)/deployments/[id]/page.tsx
    app/(dashboard)/deployments/components/deployments-table.tsx
  </files>
  <action>
    Audit and fix every page for mobile (375px), tablet (768px), and desktop (1280px) viewports. Changes should be Tailwind-only (responsive utility classes).

    1. **Dashboard page (`page.tsx`)**:
    - Header: On mobile, stack title and button vertically (`flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4`). Title text: `text-2xl sm:text-3xl`.

    2. **Dashboard metrics (`dashboard-metrics.tsx`)**:
    - Grid: Already has `md:grid-cols-2 lg:grid-cols-4`. Verify it stacks to 1-col on mobile (it should with `grid gap-4 md:grid-cols-2 lg:grid-cols-4`). No change needed if correct.

    3. **Recent jobs list (`recent-jobs-list.tsx`)**:
    - On mobile, the flex row with name + status + time can overflow. Change the job row to: wrap status and time below name on mobile. Use `flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2`. Move status badge and time into a `flex items-center gap-2` sub-row.

    4. **Training/Model Discovery page (`training/page.tsx`)**:
    - Title: `text-2xl sm:text-3xl`. No major layout issues expected since model cards are already in responsive grids.

    5. **Training Jobs page (`training/jobs/page.tsx`)**:
    - Header: Same mobile stack pattern as dashboard (`flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4`).
    - Job card params: Change `grid-cols-3` to `grid-cols-1 sm:grid-cols-3` so params stack on mobile.
    - Job card content: Stack the params and actions vertically on mobile (`flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4`).

    6. **Training Job Detail page (`training/jobs/[id]/page.tsx`)**:
    - Header: Stack title and deploy button on mobile (`flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4`).
    - Title: `text-2xl sm:text-3xl`.

    7. **Training Configure page (`training/configure/page.tsx`)**:
    - Title: `text-2xl sm:text-3xl`. Form is likely already mobile-friendly since it's a single-column form.

    8. **Deployments page (`deployments/page.tsx`)**:
    - Title: `text-2xl sm:text-3xl`.

    9. **Deployments table (`deployments/components/deployments-table.tsx`)**:
    - Wrap the Table in a `div` with `overflow-x-auto` to enable horizontal scroll on mobile instead of breaking layout. Add `min-w-[600px]` to the Table itself so columns don't compress below usable widths.

    10. **Deployment Detail page (`deployments/[id]/page.tsx`)**:
    - Header: Stack title vertically on mobile (`flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4`).
    - Title: `text-2xl sm:text-3xl`.
    - Info grid: Already has `grid-cols-1 md:grid-cols-2` -- verify.

    IMPORTANT: Only modify responsive classes. Do NOT change component structure, data fetching, or business logic. Do NOT add/remove features. These are purely layout adjustments.
  </action>
  <verify>Run `pnpm build` to verify no compilation errors. No runtime testing needed -- visual verification happens in the checkpoint plan.</verify>
  <done>All pages use responsive Tailwind classes. Headers stack on mobile. Tables scroll horizontally. Grids collapse to fewer columns on smaller viewports. Typography scales appropriately.</done>
</task>

</tasks>

<verification>
- `pnpm build` succeeds
- `motion` is in package.json dependencies
- LayoutTransition component exists with FrozenRouter pattern
- Dashboard layout wraps children in LayoutTransition
- MotionConfig has `reducedMotion="user"`
- All page headers use `flex flex-col sm:flex-row` pattern for mobile stacking
- Deployments table has horizontal scroll wrapper
- globals.css has prefers-reduced-motion media query
</verification>

<success_criteria>
- Page transitions animate smoothly between routes (fade + subtle vertical slide)
- Animations disabled when prefers-reduced-motion is active
- All pages readable and functional at 375px, 768px, and 1280px widths
- No horizontal overflow on any page at mobile viewport
- Build passes cleanly
</success_criteria>

<output>
After completion, create `.planning/phases/07-polish-and-responsive/07-02-SUMMARY.md`
</output>
